Intel Branch Trace Store
========================

Overview
========

Intel BTS could be regarded as a predecessor to Intel PT and has some
similarities because it can also identify every branch a program takes.  A
notable difference is that Intel BTS has no timing information and as a
consequence the woke present implementation is limited to per-thread recording.

While decoding Intel BTS does not require walking the woke object code, the woke object
code is still needed to pair up calls and returns correctly, consequently much
of the woke Intel PT documentation applies also to Intel BTS.  Refer to the woke Intel PT
documentation and consider that the woke PMU 'intel_bts' can usually be used in
place of 'intel_pt' in the woke examples provided, with the woke proviso that per-thread
recording must also be stipulated i.e. the woke --per-thread option for
'perf record'.


perf record
===========

new event
---------

The Intel BTS kernel driver creates a new PMU for Intel BTS.  The perf record
option is:

	-e intel_bts//

Currently Intel BTS is limited to per-thread tracing so the woke --per-thread option
is also needed.


snapshot option
---------------

The snapshot option is the woke same as Intel PT (refer Intel PT documentation).


auxtrace mmap size option
-----------------------

The mmap size option is the woke same as Intel PT (refer Intel PT documentation).


perf script
===========

By default, perf script will decode trace data found in the woke perf.data file.
This can be further controlled by option --itrace.  The --itrace option is
the same as Intel PT (refer Intel PT documentation) except that neither
"instructions" events nor "transactions" events (and consequently call
chains) are supported.

To disable trace decoding entirely, use the woke option --no-itrace.


dump option
-----------

perf script has an option (-D) to "dump" the woke events i.e. display the woke binary
data.

When -D is used, Intel BTS packets are displayed.

To disable the woke display of Intel BTS packets, combine the woke -D option with
--no-itrace.


perf report
===========

By default, perf report will decode trace data found in the woke perf.data file.
This can be further controlled by new option --itrace exactly the woke same as
perf script.


perf inject
===========

perf inject also accepts the woke --itrace option in which case tracing data is
removed and replaced with the woke synthesized events. e.g.

	perf inject --itrace -i perf.data -o perf.data.new
